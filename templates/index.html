{% extends "layout.html" %}
{% import "macros.html" as m %}

{% block content %}

{# Header #}
<nav>
    <a href="/">{% if config.extra.logo %}
        <img src="{{ config.extra.logo }}" />
        {% endif %}
        <h3>{{ config.title }}</h3>
    </a>
</nav>

{# About #}
<section class="container">
    <h2>About</h2>
    {# Get about page content from the `about.md` file in content #}
    {% set about = get_page(path="about.md") %}
    {{ about.content | safe }}
</section>

<section class="container">
    <h2>Community</h2>
    <div style="display: flex; align-items: center; ; gap: 1em;">
        <div style="display: flex; flex-direction: column;">
            <h3 style="margin: 0;">Discord</h3>
            <p>Join RustAudio on Discord to keep up with audio development within the Rust ecosystem, get help with
                DSP, collaborate on projects, and everything in-between.
                </br>
                <a class="button" style="margin-top: 1em" href={{config.extra.discord_invite}} target="_blank">Join
                    Discord</a>
            </p>

        </div>
        <a href={{config.extra.discord_invite}} class="hide-small" target="_blank">
            <img style="border-radius: 24px"
                src="https://discord.com/api/guilds/{{config.extra.discord_server_id}}/widget.png?style=banner3" />
        </a>
    </div>
</section>

{# Resources #}
<section class="container">
    <article>
        <h1>DSP resources</h1>
        {% set resources = load_data(path="content/resources.toml") %}
        {% for group, resources in resources.resources | group_by(attribute="category") %}
        <h2>{{group | capitalize}}</h2>
        {% for resource in resources %}
        <a href={{resource.url}}>{{ resource.name }}</a></br>
        {% endfor %}
        {% endfor %}
    </article>
</section>

<section>
    <h2 class="container-full">RustAudio Crates</h2>
    <div class="crates">
        {% set crates = load_data(url=config.extra.repos_url, format="json") %}
        {% for crate in crates | sort(attribute="updated_at") | reverse %}
        <div class="crate">
            <a href={{crate.svn_url}}>
                <h4>
                    <pre>{{ crate.name }}</pre>
                </h4>
            </a>
            <div class="details">
                <div class="stars">{{ crate.stargazers_count }} â˜†</div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

{% endblock content %}